<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" type="text/css" href="./css/style.css" />
    <title>Sign Up - 2H Second-Hand</title>
</head>

<body>
    <div class="container-fluid">
        <div id="Header">
            <div class="header-content">
                <div class="title-logo-wrapper">
                    <h1 class="site-title">2H Second-Hand</h1>
                    <img src="images/logoHKHuang01.jpg" alt="Logo" class="logo">
                </div>
            </div>
        </div>
        <div id="navbar"></div>
        <div class="card mt-3">
            <div class="card-header">Sign up</div>

            <div class="card-body">
                <form action="signup_process.html" method="post" class="needs-validation" novalidate
                    enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" name="email" required />
                        <div class="invalid-feedback">Email cannot be left blank.</div>
                    </div>

                    <div class="mb-3">
                        <label for="fullname" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="fullname" name="fullname" required />
                        <div class="invalid-feedback">Full Name cannot be left blank.</div>
                    </div>

                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" name="password"
                            autocomplete="new-password" required />
                        <div class="invalid-feedback">Password cannot be left blank.</div>
                    </div>

                    <div class="mb-3">
                        <label for="repassword" class="form-label">Confirm password</label>
                        <input type="password" class="form-control" id="repassword" name="repassword"
                            autocomplete="new-password" required />
                        <div class="invalid-feedback">Confirm password cannot be left blank</div>
                    </div>

                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-person-add"></i> Sign up
                    </button>
                    <a href="index.html" class="btn btn-secondary ms-2">
                        <i class="bi bi-arrow-left-circle"></i> Back to Home
                    </a>
                </form>
            </div>
        </div>
        <div id="footer"></div>
    </div>

    <script>
        // Cách đúng để đảm bảo JQuery code chạy khi DOM đã sẵn sàng
        $(document).ready(function () {
            $("#navbar").load("inc/navbar.html");
            $("#footer").load("inc/footer.html");

            // Chuyển logic validation và xử lý form vào đây
            const form = document.querySelector(".needs-validation");

            form.addEventListener("submit", (event) => {
                // Kiểm tra validation của form Bootstrap
                if (!form.checkValidity()) {
                    event.preventDefault(); // Ngăn form submit mặc định
                    event.stopPropagation(); // Ngăn sự kiện lan truyền
                } else {
                    // Nếu form hợp lệ, ngăn submit mặc định để xử lý bằng JS
                    event.preventDefault(); 

                    const fullname = $("#fullname").val();
                    const email = $("#email").val();
                    const password = $("#password").val();
                    const repassword = $("#repassword").val();

                    if (password !== repassword) {
                        alert("Password and confirm password do not match!");
                        // Ngăn không cho form submit nếu mật khẩu không khớp
                        return; 
                    }
                    
                    // Lưu dữ liệu vào LocalStorage
                    localStorage.setItem("fullname", fullname);
                    localStorage.setItem("email", email);
                    localStorage.setItem("password", password);

                    // Chuyển hướng sang trang xử lý
                    window.location.href = "signup_process.html";
                }
                // Luôn thêm class 'was-validated' để hiển thị feedback cho người dùng
                form.classList.add("was-validated");
            });
        });
    </script>
</body>

</html>
